<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.icia.web.dao.ShopDao">

<!-- 상품 resultMap -->
<resultMap id = "productResultMap" type="com.icia.web.model.Product">
	<id column="PRODUCT_NO" property="productNo" /> <!--  id는 보통 PK로 씀 -->
	<result column="CATEGORY_CODE" property="categoryCode" />    <!--select할때 name, email사용하려고 추가-->
	<result column="PRODUCT_NAME" property="productName" /> 
	<result column="PRODUCT_PRICE" property="productPrice" /> 
	<result column="PRODUCT_CONTENT" property="productContent" /> 
	<result column="PRODUCT_REG_DATE" property="productRegDate" /> 
</resultMap>

<resultMap id = "productFlieResultMap" type="com.icia.web.model.ProductFile"> 
	<id column="PRODUCT_NO" property="productNo" />
	<id column="FILE_SEQ" property="fileSeq" />
	<result column="FILE_ORG_NAME" property="fileOrgName" />
	<result column="FILE_NAME" property="fileName" />
	<result column="FILE_EXT" property="fileExt" />
	<result column="FILE_SIZE" property="fileSize" />
	<result column="CATEGORY_CODE" property="categoryCode" /> 
	<result column="PRODUCT_REG_DATE" property="productRegDate" />
</resultMap>



<!-- 게시물등록 -->
<insert id="productInsert" parameterType="com.icia.web.model.Product">	
<!-- 선행처리기(시퀀스 생성) -->
<selectKey resultType="Long" keyProperty="productNo" order="BEFORE">
	SELECT SEQ_PRODUCT_SEQ.NEXTVAL FROM DUAL
</selectKey>
	INSERT INTO TBL_PRODUCT (
	    PRODUCT_NO,
	    PRODUCT_NAME,
	    PRODUCT_PRICE,
	    PRODUCT_CONTENT,
	    PRODUCT_REG_DATE
	) VALUES (
	    #{productNo},	
	    #{productName},
	    #{productPrice},
	    #{productContent},
	    SYSDATE
	)
</insert>


<!-- 첨부파일 등록 -->
<insert id="productFileInsert" parameterType="com.icia.web.model.ProductFile">
	INSERT INTO TBL_PRODUCT_FILE (
	    PRODUCT_NO,
	    FILE_SEQ,
	    FILE_ORG_NAME,
	    FILE_NAME,
	    FILE_EXT,
	    FILE_SIZE,
	    PRODUCT_REG_DATE
	) VALUES (
	    #{productNo},
	    #{fileSeq},
	    #{fileOrgName},
	    #{fileName},
	    #{fileExt},
	    #{fileSize},
	    SYSDATE
	)
</insert>

</mapper>
